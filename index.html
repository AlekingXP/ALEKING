<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Corazones que sanan ‚ù§Ô∏è</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0f1020; --bg2:#1a1033; --rose:#ff4d6d; --rose-dark:#d6336c;
      --glow:#ffd6e0; --white:#ffffff; --glass: rgba(255,255,255,.6);
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0; font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--white);
      background: radial-gradient(1200px 600px at 50% -100px, #2b1a40 0%, transparent 60%) ,
                  linear-gradient(160deg,var(--bg1),var(--bg2));
      overflow:hidden;
    }

    /* Layout */
    .app{position:relative; min-height:100%; display:grid; place-items:center; padding:24px;}
    .stage{position:relative; width:min(100%,900px);}
    .hearts{display:grid; gap:28px; place-items:center;}

    /* Top full heart */
    #fullHeart{cursor:pointer; filter: drop-shadow(0 8px 24px rgba(255,77,109,.35)); transition: transform .2s ease;
      width:160px; height:auto;
    }
    #fullHeart:hover{transform: scale(1.04)}

    /* Broken heart container */
    .broken-wrap{position:relative; width:220px; height:200px;}
    svg{display:block}

    /* Lottie-like soft pulse */
    .pulse{animation:pulse 2.2s ease-in-out infinite}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}

    /* Join progress affects halves */
    .half{transform-origin:center; transition: transform .45s cubic-bezier(.2,.9,.2,1);}

    /* Rain of emojis */
    .rain{pointer-events:none; position:fixed; inset:0; overflow:hidden;}
    .drop{position:absolute; top:-3rem; font-size:clamp(18px,3.8vw,40px); opacity:.9; animation:fall linear forwards;}
    @keyframes fall{to{transform:translateY(110vh) rotate(360deg); opacity:.95}}

    /* Modal letter */
    .modal{position:fixed; inset:0; display:grid; place-items:center; padding:20px; z-index:5; opacity:0; pointer-events:none; transition:opacity .35s ease}
    .modal.open{opacity:1; pointer-events:auto}
    .backdrop{position:absolute; inset:0; background:rgba(10,10,20,.65);}

    .letter{position:relative; width:min(900px,92vw); max-height:min(760px,86vh); border-radius:24px; overflow:hidden; box-shadow:0 30px 80px rgba(0,0,0,.55)}
    .letter-bg{position:absolute; inset:0; background-position:center; background-size:cover; filter:blur(6px) saturate(1.1); transform:scale(1.06); opacity:.55}
    .letter-glass{position:relative; backdrop-filter: blur(6px); background: linear-gradient(to bottom, rgba(255,255,255,.70), rgba(255,255,255,.45)); color:#221;}

    .letter-header{display:flex; align-items:center; gap:14px; padding:18px 20px 6px 20px;}
    .badge{font-weight:700; background:#ffb3c1; color:#7a1230; padding:.25rem .55rem; border-radius:999px; font-size:.8rem}

    .content{display:grid; grid-template-columns: 1fr 1fr; gap:16px; padding:14px 20px 20px 20px;}
    .photo{position:relative; aspect-ratio:1/1; width:100%; border-radius:18px; overflow:hidden; box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .photo img{width:100%; height:100%; object-fit:cover; filter:blur(1.5px) contrast(1.05); transform:scale(1.04)}
    .photo::after{content:""; position:absolute; inset:0; background:radial-gradient(closest-side, rgba(255,255,255,.05), transparent 60%), linear-gradient(180deg, rgba(255,255,255,.25), rgba(255,255,255,0));}

    .poems{min-height:220px; max-height:56vh; overflow:auto; padding:8px 6px;}
    .poem{background:rgba(255,255,255,.75); border:1px solid rgba(255,85,120,.25); border-radius:14px; padding:14px 14px; margin-bottom:10px; box-shadow:0 4px 14px rgba(0,0,0,.08)}
    .poem h4{margin:.1rem 0 .4rem 0; color:#7a1230}
    .poem p{margin:0; color:#35121f}

    .letter-footer{display:flex; justify-content:space-between; align-items:center; padding:10px 16px 16px 16px}
    .btn{appearance:none; border:none; border-radius:999px; padding:10px 16px; font-weight:700; cursor:pointer; box-shadow:0 8px 18px rgba(0,0,0,.2)}
    .btn.primary{background:linear-gradient(180deg, var(--rose), var(--rose-dark)); color:white}
    .btn.ghost{background:rgba(255,255,255,.85)}

    /* Responsive */
    @media (max-width: 820px){
      .content{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="stage">
      <div class="hearts">
        <!-- Full heart (tap me) -->
        <svg id="fullHeart" class="pulse" viewBox="0 0 512 512" aria-label="Coraz√≥n completo" role="img">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#ff5f87"/>
              <stop offset="100%" stop-color="#ff2d55"/>
            </linearGradient>
          </defs>
          <path fill="url(#g)" d="M256 464s-24-20-64-52C118 343 64 295 64 208c0-61 45-112 112-112 44 0 73 24 80 32 7-8 36-32 80-32 67 0 112 51 112 112 0 87-54 135-128 204-40 32-64 52-64 52z"/>
        </svg>

        <!-- Broken heart (heals on taps) -->
        <div class="broken-wrap" aria-label="Coraz√≥n partido">
          <svg id="broken" viewBox="0 0 512 512">
            <defs>
              <linearGradient id="gb" x1="0" y1="0" x2="1" y2="1">
                <stop offset="0%" stop-color="#ffccd5"/>
                <stop offset="100%" stop-color="#ff7b93"/>
              </linearGradient>
              <clipPath id="clip-left"><rect x="0" y="0" width="256" height="512"/></clipPath>
              <clipPath id="clip-right"><rect x="256" y="0" width="256" height="512"/></clipPath>
            </defs>
            <!-- same path twice, clipped to halves -->
            <g id="leftHalf" class="half" clip-path="url(#clip-left)">
              <path fill="url(#gb)" d="M256 464s-24-20-64-52C118 343 64 295 64 208c0-61 45-112 112-112 44 0 73 24 80 32 7-8 36-32 80-32 67 0 112 51 112 112 0 87-54 135-128 204-40 32-64 52-64 52z"/>
            </g>
            <g id="rightHalf" class="half" clip-path="url(#clip-right)">
              <path fill="url(#gb)" d="M256 464s-24-20-64-52C118 343 64 295 64 208c0-61 45-112 112-112 44 0 73 24 80 32 7-8 36-32 80-32 67 0 112 51 112 112 0 87-54 135-128 204-40 32-64 52-64 52z"/>
            </g>
          </svg>
        </div>
        <div style="opacity:.8;font-size:.95rem">Toca el coraz√≥n de arriba para sanar el de abajo ‚ú®</div>
      </div>
    </div>
  </div>

  <!-- Rain container -->
  <div class="rain" id="rain"></div>

  <!-- Letter Modal -->
  <div class="modal" id="modal">
    <div class="backdrop"></div>
    <div class="letter">
      <div class="letter-bg" id="letterBg"></div>
      <div class="letter-glass">
        <div class="letter-header">
          <span class="badge">Para ti</span>
          <h2 style="margin:0; font-weight:800; letter-spacing:.5px; color:#6f1230">Carta de Poemas</h2>
        </div>
        <div class="content">
          <div class="photo">
            <!-- Reemplaza src por tu foto -->
            <img id="photo" src="tu-foto.jpg" alt="Foto al centro" />
          </div>
          <div class="poems" id="poems">
            <div class="poem"><h4>1) Latido</h4><p>Tu nombre cabe entero en un latido, y el eco me regresa siempre a ti.</p></div>
            <div class="poem"><h4>2) Ventana</h4><p>Tu risa abre ventanas en mis d√≠as nublados y entra un sol que no sab√≠a que exist√≠a.</p></div>
            <div class="poem"><h4>3) Cauce</h4><p>Si soy r√≠o, t√∫ eres cauce; por donde paso florece el mundo.</p></div>
            <div class="poem"><h4>4) Secreto</h4><p>Guardo en el bolsillo un secreto: el universo me habl√≥ de ti primero.</p></div>
            <div class="poem"><h4>5) Hogar</h4><p>Hay casas sin paredes: tus brazos cuando digo tu nombre.</p></div>
            <div class="poem"><h4>6) Faro</h4><p>Si la noche se alarga, eres faro; si amanece, eres canci√≥n.</p></div>
            <div class="poem"><h4>7) Brisa</h4><p>Te pienso y el aire aprende danza, suave como tu voz.</p></div>
            <div class="poem"><h4>8) Destino</h4><p>Nos miramos: el camino se dibuj√≥ solo.</p></div>
            <div class="poem"><h4>9) Sue√±o</h4><p>En mis sue√±os te encuentro; al despertar, me quedo.</p></div>
            <div class="poem"><h4>10) Siempre</h4><p>Si la vida pregunta por mi norte, digo tu risa.</p></div>
          </div>
        </div>
        <div class="letter-footer">
          <button class="btn ghost" id="again">Volver a unir otra vez</button>
          <button class="btn primary" id="close">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- Emoji rain ---
    const rain = document.getElementById('rain');
    const EMOJIS = ['üß∏','üíñ','‚≠ê'];
    function spawnRain(count=36){
      for(let i=0;i<count;i++){
        const span = document.createElement('span');
        span.className = 'drop';
        span.textContent = EMOJIS[Math.floor(Math.random()*EMOJIS.length)];
        span.style.left = Math.random()*100 + 'vw';
        const d = 6 + Math.random()*6; // duration 6-12s
        span.style.animationDuration = d+'s';
        span.style.animationDelay = (Math.random()*-12)+'s';
        rain.appendChild(span);
        // cleanup when off-screen
        setTimeout(()=> span.remove(), (d+12)*1000);
      }
    }
    // start gentle rain
    spawnRain(30);
    // loop spawns
    setInterval(()=>spawnRain(12), 2800);

    // --- Healing broken heart ---
    const fullHeart = document.getElementById('fullHeart');
    const leftHalf = document.getElementById('leftHalf');
    const rightHalf = document.getElementById('rightHalf');
    const modal = document.getElementById('modal');
    const closeBtn = document.getElementById('close');
    const againBtn = document.getElementById('again');
    const letterBg = document.getElementById('letterBg');
    const photo = document.getElementById('photo');

    let progress = 0; // 0..10
    const MAX = 10;

    // initial broken pose
    function setHalves(p){
      const t = 1 - p/MAX; // 1->0
      const gap = 70 * t; // pixels
      const rot = 14 * t; // degrees
      leftHalf.style.transform = `translateX(${-gap}px) rotate(${-rot}deg)`;
      rightHalf.style.transform = `translateX(${gap}px) rotate(${rot}deg)`;
    }
    setHalves(0);

    function step(){
      if(progress < MAX){
        progress++;
        setHalves(progress);
        if(progress === MAX){
          // open the letter after a tiny delay
          setTimeout(()=> openLetter(), 420);
        }
      }
    }

    function openLetter(){
      // use the same center photo as subtle background
      const src = photo.getAttribute('src') || '';
      letterBg.style.backgroundImage = src ? `url(${src})` : 'linear-gradient(135deg,#ffd6e0,#ffe9f1)';
      modal.classList.add('open');
      // launch celebratory rain
      spawnRain(40);
      setTimeout(()=>spawnRain(40), 800);
    }

    fullHeart.addEventListener('click', step);
    fullHeart.addEventListener('touchstart', (e)=>{ e.preventDefault(); step(); }, {passive:false});

    closeBtn.addEventListener('click', ()=>{
      modal.classList.remove('open');
    });

    againBtn.addEventListener('click', ()=>{
      modal.classList.remove('open');
      progress = 0; setHalves(0);
      // a gentle cue
      fullHeart.classList.add('pulse');
      setTimeout(()=> fullHeart.classList.remove('pulse'), 2000);
    });

    // Helper: press Enter to step (for desktop demo)
    window.addEventListener('keydown', (e)=>{ if(e.key==='Enter') step(); });
  </script>
</body>
</html>
